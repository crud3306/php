

HTTP协议中几个状态码的含义:503 500 401 403 404 200 301 302。。。
---------------
```
1xx 临时响应
	100（继续）请求者应当继续提出请求。服务器返回此代码表示已收到请求的第一部分，正在等待其余部分。

	101（切换协议）请求者已要求服务器切换协议，服务器已确认并准备切换。

2XX 成功
	200 : 请求成功，请求的数据随之返回。

3XX 重定向
	301 : 永久性重定向。请求的网页已永久移动到新位置。

	302 : 暂时行重定向。服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来响应以后的请求。

	304 ：未修改，一般用于协商缓存  

	305 ：使用代理 请求者只能使用代理访问请求的网页。如果服务器返回此响应，还表示请求者应使用代理。

	307 ：临时重定向

4XX 请求错误

	401 : （未授权）当前请求需要用户验证。

	403 : （禁止） 服务器拒绝请求。

	404 : （未找到）请求失败，请求的数据在服务器上未发现。

	405 ：（方法禁用） 禁用请求中指定的方法。

	407 ：（需要代理授权） 此状态代码与 401（未授权）类似，但指定请求者应当授权使用代理。

5xx 服务器错误

	500 : 服务器错误。一般服务器端程序执行错误。

	501 ：（尚未实施） 服务器不具备完成请求的功能，例如，服务器无法识别请求方法时可能会返回此代码。  

	502 ：（错误网关） 服务器作为网关或代理，从上游服务器收到无效响应。

	503 : （服务不可用）服务器临时维护或过载。这个状态时临时性的。

	504 ：（网关超时） 服务器作为网关或代理，但是没有及时从上游服务器收到请求。

	505 ：（HTTP 版本不受支持） 服务器不支持请求中所用的 HTTP 协议版本。
```


什么是restful api
---------------
REST是所有Web应用都应该遵守的架构设计指导原则。 
Representational State Transfer，翻译是”表现层状态转化”。 
面向资源是REST最明显的特征，对于同一个资源的一组不同的操作。资源是服务器上一个可命名的抽象概念，资源是以名词为核心来组织的，首先关注的是名词。REST要求，必须通过统一的接口来对资源执行各种操作。对于每个资源只能执行一组有限的操作。（7个HTTP方法：GET/POST/PUT/DELETE/PATCH/HEAD/OPTIONS）

符合REST设计标准的API，即RESTful API。  

POST   /uri     创建  
DELETE /uri/xxx 删除   
PUT    /uri/xxx 更新或创建  
GET    /uri/xxx 查看  

注：PUT，DELETE操作是幂等的


长连接和短连接的使用
---------------
参考：https://www.sohu.com/a/165361260_505885  

定义：

短连接：例如普通的web请求，在三次握手之后建立连接，发送数据包并得到服务器返回的结果之后，通过客户端和服务端的四次握手进行关闭断开。

长连接：区别于短连接，由于三次握手链接及四次握手断开，在请求频繁的情况下，链接请求和断开请求的开销较大，影响效率。采用长连接方式，执行三次握手链接后，不断开链接，保持客户端和服务端通信，直到服务器超时自动断开链接，或者客户端主动断开链接。

适用场景：

短连接：适用于网页浏览等数据刷新频度较低的场景。

长连接：适用于客户端和服务端通信频繁的场景，例如聊天室，实时游戏等。



长连接，指在一个TCP连接上可以连续发送多个数据包，在TCP连接保持期间，如果没有数据包发送，需要双方发检测包以维持此连接，一般需要自己做在线维持。  

长连接通常就是：

连接→数据传输→保持连接(心跳)→数据传输→保持连接(心跳)→……→关闭连接；

长连接多用于操作频繁，点对点的通讯，而且连接数不能太多情况，

例如：数据库的连接用长连接， 如果用短连接频繁的通信会造成socket错误，而且频繁的socket 创建也是对资源的浪费。

短连接是指通信双方有数据交互时，就建立一个TCP连接，数据发送完成后，则断开此TCP连接，

操作步骤是：

连接→数据传输→关闭连接；

例如：一般银行都使用短连接。 WEB网站的http服务一般都用短链接



测试php性能和mysql数据库性能的工具,和找出瓶颈的方法
---------------
XHProf是一个分析php性能的工具，他报告函数基本的请求次数和各种指标，包括阻塞时间、cpu时间和内存使用情况，有一个简单的ＨＴＭＬ用户界面，给予浏览器的性能分析用户界面，也能绘制调用关系    
安装地址： 
https://blog.csdn.net/qq_28602957/article/details/72697901    



HTTP 协议的原理，什么是全双工，什么是半双工?  
------------
HTTP协议是Hyper Text Transfer Protocol（超文本传输协议）的缩写,是用于从万维网（WWW:World Wide Web ）服务器传输超文本到本地浏览器的传送协议，是无状态协议。  
HTTP协议定义Web客户端如何从Web服务器请求Web页面，以及服务器如何把Web页面传送给客户端。HTTP协议采用了请求/响应模型。客户端向服务器发送一个请求报文，请求报文包含请求的方法、URL、协议版本、请求头部和请求数据。服务器以一个状态行作为响应，响应的内容包括协议的版本、成功或者错误代码、服务器信息、响应头部和响应数据。  

全双工（Full Duplex）是指请求和响应同时进行，也就是说在发送数据的同时也能够接收数据，两者同步进行。这好像我们平时打电话一样，说话的同时也能够听到对方的声音。目前的网卡一般都支持全双工。  

半双工（Half Duplex），所谓半双工就是指一个时间段内只有一个动作发生，举个简单例子:一条窄窄的马路，同时只能有一辆车通过，当目前有两量车对开，这种情况下就只能一辆先过，等到头儿后另一辆再开，这个例子就形象的说明了半双工的原理。早期的对讲机、以及早期集线器等设备都是基于半双工的产品。随着技术的不断进步，半双工会逐渐退出历史舞台。  


http header大小，body大小
-------------
均可在服务端控制  
比如nginx的：  
large_client_header_buffers 这个属性，控制header大小，它默认是4k     
client_max_body_size，这个参数可以限制body的大小，默认是1m    


http缓存机制
------------
本地缓存（强制缓存）  
	expires  
	cache_control  

协商缓存（对比缓存）304    
	一种：    
	Last-Modified：服务器通知浏览器资源的最后修改时间    
	If-Modified-Since：浏览器会将得到资源的最后修改时间通过If-Modified-Since提交到服务器做检查，如果没有修改，返回304状态码    
	   
	另一种：  
	ETag：http1.1推出，文件的指纹标识符，如果文件内容修改，指纹会改变  
	If-None-Match：本地缓存失效，会携带此值去请求服务端，服务端判断该资源是否改变，如果没有改变，直接使用本地缓存，返回304 




HTTPS和HTTP的区别： 
-------------
https协议需要到ca申请证书，一般免费证书很少，需要交费。 
http是超文本传输协议，信息是明文传输，https 则是具有安全性的ssl加密传输协议。 
http和https使用的是完全不同的连接方式用的端口也不一样,前者是80,后者是443。 


URI和URL的区别  
-------------
URI，是uniform resource identifier，统一资源标识符，用来唯一的标识一个资源。  
Web上可用的每种资源如HTML文档、图像、视频片段、程序等都是一个来URI来定位的
URI一般由三部组成：  
①访问资源的命名机制  
②存放资源的主机名  
③资源自身的名称，由路径表示，着重强调于资源。  
  
URL是uniform resource locator，统一资源定位器，它是一种具体的URI，即URL可以用来标识一个资源，而且还指明了如何locate这个资源。  
URL是Internet上用来描述信息资源的字符串，主要用在各种WWW客户程序和服务器程序上，特别是著名的Mosaic。  
采用URL可以用一种统一的格式来描述各种信息资源，包括文件、服务器的地址和目录等。URL一般由三部组成：  
①协议(或称为服务方式)  
②存有该资源的主机IP地址(有时也包括端口号)  
③主机资源的具体地址。如目录和文件名等   


同源策略、跨域解决方案
-----------
1、先来说说什么是源  
源（origin）就是协议、域名和端口号。  
比如一个url中的源就是：http://www.company.com:80  

若地址里面的协议、域名和端口号均相同则属于同源。  
以下是相对于 http://www.a.com/test/index.html 的同源检测
```
•	http://www.a.com/dir/page.html ----成功
•	http://www.child.a.com/test/index.html ----失败，域名不同
•	https://www.a.com/test/index.html ----失败，协议不同
•	http://www.a.com:8080/test/index.html ----失败，端口号不同
```
  
2.什么是同源策略？  
同源策略是浏览器的一个安全功能，不同源的客户端脚本在没有明确授权的情况下，不能读写对方资源。所以a.com下的js脚本采用ajax读取b.com里面的文件数据是会报错的。  

不受同源策略限制的：  
1、页面中的链接，重定向以及表单提交是不会受到同源策略限制的。  
2、跨域资源的引入是可以的。但是js不能读写加载的内容。如嵌入到页面中的<script src="..."></script>，<img>，<link>，<iframe>等。  
  
二、跨域  
1、什么是跨域  
受前面所讲的浏览器同源策略的影响，不是同源的脚本不能操作其他源下面的对象。想要操作另一个源下的对象是就需要跨域。    

2、跨域的实现方式    
  1) JSONP跨域  
JSONP和JSON并没有什么关系！  
JSONP由来：  
ajax请求受同源策略影响，不允许进行跨域请求，而script标签src属性中的链接却可以访问跨域的js脚本，利用这个特性，服务端不再返回JSON格式的数据，而是返回一段调用某个函数的js代码，在src中进行了调用，这样实现了跨域。 
JSONP原理：
首先在客户端注册一个callback，然后把callback的名字传给服务器。此时，服务器先生成json数据，然后以javascript语法的方式，生成function，function名字就是传递上来I带参数jsonp。最后将json数据直接以入参的方式，放置function中，这样就生成js语法的文档，返回给客户端。客户端浏览器，解析script变迁，并执行返回javascript文档，此时数据作为参数，传入了客户端预先定义好的callback函数里。简单的说，就是利用script标签没有跨域限制的“漏洞”来达到与第三方通讯的目的。  

  2) CORS  
CORS是一个W3C标准，全称是"跨域资源共享"（Cross-origin resource sharing）。  
它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。  
在访问的服务器响应头中加上:  
Access-Control-Allow-Origin: http://xxxxx.com  
如果是文件上传还需加上：
 
  
  3) 降域 document.domain  
同源策略认为域和子域属于不同的域，如：  
child1.a.com 与 a.com，  
child1.a.com 与 child2.a.com，  
xxx.child1.a.com 与 child1.a.com  
两两不同源，可以通过设置 document.damain='a.com'，浏览器就会认为它们都是同一个源。  
降域的特点：
1.	只能在父域名与子域名之间使用，且将 xxx.child1.a.com域名设置为a.com后，不能再设置成child1.a.com。
2.	存在安全性问题，当一个站点被攻击后，另一个站点会引起安全漏洞。
3.	这种方法只适用于 Cookie 和 iframe 窗口。


一次完整的 http 请求详解
----------------
1）客户端输入 URL 。  

2）客户端检测缓存（有缓存且较新，客户端直接读取本地缓存进行资源展示，有缓存但是不新，准备 http 请求包,发送至服务端进行缓存校验）。

3）提取请求首部 HOST通过 DNS 域名解析获取服务 IP(DNS 缓存递归等)。

4）通过 IP 与默认端口创建 TCP 连接,进行 http 请求报文数据发送,其中重点就三次握手进行描述（客户端向服务端发送 syn，服务端向客户端发送 syn、ack，客户端向服务端发送 syn，ack，data）。

5）服务端程序接受请求，定向到请求路径处理程序，准备http响应。

6）通过建立的tcp连接来返回相关的http响应报文及http状态信息，然后根据实际情况看是否关闭连接( Connection的keep-alive )。

7）TCP 连接关闭经历 4 次握手。

8）客户端拿到 http 响应的报文信息，经过一系列前端处理过程最终将请求的资源进行展示。  

  

tcp 报头有哪些选项及其作用
--------------
源端口、目的端口、顺序号seq、确认序号ack、偏移量、标志、窗口、校验和、紧急指针、可变项  

按顺序依次为
```
32位 端口号：源端口、目的端口，各占16位  

32位 序号：也叫顺序号（Sequence Number），简写为SEQ  

32位 确认序号：也称为应答号（Acknowledgment Number），简写为ACK。在握手阶段，确认序号将发送方的序号加1作为回答。  

4位 首部长度：

6位 标志字段：
ACK 置1时表示确认号（为合法，为0的时候表示数据段不包含确认信息，确认号被忽略。
RST 置1时重建连接。如果接收到RST位时候，通常发生了某些错误。
SYN 置1时用来发起一个连接。
FIN 置1时表示发端完成发送任务。用来释放连接，表明发送方已经没有数据发送了。
URG 紧急指针，告诉接收TCP模块紧要指针域指着紧要数据。注：一般不使用。
PSH 置1时请求的数据段在接收方得到后就可直接送到应用程序，而不必等到缓冲区满时才传送。注：一般不使用。

16位 检验和：
检验和覆盖了整个的TCP报文段： TCP首部和TCP数据。这是一个强制性的字段，一定是由发端计算和存储，并由收端进行验证。

16位紧急指针：
注：一般不使用。
只有当URG标志置1时紧急指针才有效。紧急指针是一个正的偏移量，和序号字段中的值相加表示紧急数据最后一个字节的序号。  

可选与变长选项：
通常为空，可根据首部长度推算。用于发送方与接收方协商最大报文段长度（MSS），或在高速网络环境下作窗口调节因子时使用。首部字段还定义了一个时间戳选项。
```


udp 报头有哪些选项及其作用
-------------
源端口、目的端口  
数据包长度、校验值  



WebSocket 是什么？ 
--------------
WebSocket是HTML5规范提出的一种协议；目前除了完犊子的IE浏览器，其他浏览器都基本支持。他是一种协议，万变不离其宗，也是基于TCP协议的


WebSocket与Socket的关系
--------------
Socket其实并不是一个协议，而是为了方便使用TCP或UDP而抽象出来的一层，是位于应用层和传输控制层之间的一组接口。

“Socket是应用层与TCP/IP协议族通信的中间软件抽象层，它是一组接口，提供一套调用TCP/IP协议的API。在设计模式中，Socket其实就是一个门面模式，它把复杂的TCP/IP协议族隐藏在Socket接口后面，对用户来说，一组简单的接口就是全部，让Socket去组织数据，以符合指定的协议。”

当两台主机通信时，必须通过Socket连接，Socket则利用TCP/IP协议建立TCP连接。TCP连接则更依靠于底层的IP协议，IP协议的连接则依赖于链路层等更低层次。

WebSocket就像HTTP一样，则是一个典型的应用层协议。


WebSocket与HTTP的关系 
--------------
相同点：  
1. 都是一样基于TCP的，都是可靠性传输协议。  
2. 都是应用层协议。   

不同点：  
1. WebSocket是双向通信协议，模拟Socket协议，可以双向发送或接受信息。HTTP是单向的。  
2. WebSocket是需要浏览器和服务器握手进行建立连接的。而http是浏览器发起向服务器的连接，服务器预先并不知道这个连接。  

联系：  
WebSocket在建立握手时，数据是通过HTTP传输的。但是建立之后，在真正传输时候是不需要HTTP协议的。  

总结：
在WebSocket中，只需要服务器和浏览器通过HTTP协议进行一个握手的动作，然后单独建立一条TCP的通信通道进行数据的传送。 

WebSocket连接的过程是：  
首先，客户端发起http请求，经过3次握手后，建立起TCP连接；http请求里存放WebSocket支持的版本号等信息，如：Upgrade、Connection、WebSocket-Version等；  
然后，服务器收到客户端的握手请求后，同样采用HTTP协议回馈数据；  
最后，客户端收到连接成功的消息后，开始借助于TCP传输信道进行全双工通信。  

```
$server = new swoole_websocket_server("127.0.0.1", 9502);

$server->on('open', function($server, $req) {
    echo "connection open: {$req->fd}\n";
});

$server->on('message', function($server, $frame) {
    echo "received message: {$frame->data}\n";
    $server->push($frame->fd, json_encode(["hello", "world"]));
});

$server->on('close', function($server, $fd) {
    echo "connection close: {$fd}\n";
});

$server->start();
```


swoole
-----------
Swoole是一个PHP扩展，扩展不是为了提升网站的性能，是为了提升网站的开发效率。最少的性能损耗，换取最大的开发效率。利用Swoole扩展，开发一个复杂的Web功能，可以在很短的时间内完成了。

Swoole 使用纯 C 语言编写，提供了 PHP 语言的异步多线程服务器。



